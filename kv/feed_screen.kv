# 1. ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á PostCard

<PostCard>:
    orientation: "vertical"
    size_hint_y: None
    # ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ + ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏£‡∏¥‡∏á
    height: self.minimum_height
    padding: "15dp"
    spacing: "12dp"
    canvas.before:
        Color:
            rgba: 0.2, 0.2, 0.22, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [12,]

    # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: Header (‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤) ---
    BoxLayout:
        orientation: "vertical"
        size_hint_y: None
        height: "50dp"  # ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
        Label:
            text: root.username
            bold: True
            font_size: "16sp"
            text_size: self.width, None
            halign: "left"
        Label:
            text: root.timestamp
            font_size: "11sp"
            color: 0.6, 0.6, 0.6, 1
            text_size: self.width, None
            halign: "left"

    # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: Content (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏û‡∏™‡∏ï‡πå) ---
    Label:
        text: root.content
        size_hint_y: None
        # ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏´‡πâ Label ‡∏™‡∏π‡∏á‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏î‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏£‡∏¥‡∏á
        height: self.texture_size[1] + dp(10)
        text_size: self.width, None
        halign: "left"
        valign: "top"
        font_size: "14sp"

    # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: Image --- 
    BoxLayout:
        size_hint_y: None
        # ‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Å‡∏ß‡πà‡∏≤ Box ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÑ‡∏´‡∏°
        height: dp(250) if root.image else 0 
        opacity: 1 if root.image else 0
        
        Image:
            source: root.image
            fit_mode: "contain"
            

    # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: Footer (‡∏õ‡∏∏‡πà‡∏° Like) ---
    BoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: "40dp"
        Button:
            id: like_btn
            text: "üëç Like" if not root.is_liked else "‚ù§Ô∏è Liked"
            size_hint_x: None
            width: "100dp"
            on_release: root.toggle_like()
        Label:
            text: str(int(root.likes)) + " Likes"
            halign: "right"
            text_size: self.size
            valign: "middle"

# 2. ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤ FeedScreen
<FeedScreen>:
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 0.1, 0.1, 0.12, 1
            Rectangle:
                pos: self.pos
                size: self.size
        

    RecycleView:
        id: feed_rv
        viewclass: 'PostCard'
        RecycleBoxLayout:
            default_size: None, None
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'
            spacing: "20dp"  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î
            padding: "10dp"
            # ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ RV ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
            key_size: 'height'